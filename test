
                // Grouping and adding changes
                int start = i;
                while (i < totalLines && (i - start < maxLinesPerSlide)) {
                    String currentChange = changes.get(i);
                    String sign = currentChange.substring(0, 1);
                    int currentLine = Integer.parseInt(currentChange.split(":")[1].trim().split(" ")[0]);

                    // Group lines with the same sign
                    int groupEnd = i;
                    while (groupEnd + 1 < totalLines && changes.get(groupEnd + 1).startsWith(sign)) {
                        groupEnd++;
                    }

                    String formattedChange = formatChanges(changes.subList(i, groupEnd + 1));
                    XSLFTextParagraph diffContentParagraph = diffContent.addNewTextParagraph();
                    XSLFTextRun diffContentRun = diffContentParagraph.addNewTextRun();
                    diffContentRun.setText(formattedChange);
                    if (sign.equals("+")) {
                        diffContentRun.setFontColor(Color.GREEN);
                    } else if (sign.equals("-")) {